# Test Substitute Command

# 1. Test sub atom
add mol xyz <<END
3
Test Atom
C 0 0 0
H 1 0 0
H -1 0 0
END

select :
sub atom 1 O
# Expect C at index 1 (0-based) to become O. (Wait, index 1 is 2nd atom. 0-based index in command? 
# CommandRegistry says: const idx = parseInt(args[1]) - 1; // 1-based to 0-based
# So "sub atom 1" targets index 0 (1st atom).
# Let's verify.
# If I say "sub atom 1 O", it targets atom 1 (C).

# 2. Test sub grp (Explicit)
# Create Target Mol
new TargetMol
add atom C 0 0 0
add atom H 1.5 0 0
bond 1 2

# Create Source Mol
new SourceMol
add atom N 0 0 0
add atom H 1.5 0 0
bond 1 2

# Switch to Target
switch 2

# Substitute: Target(2) replaced by Source(1) attached at Source(2)
# Target: Leaving=2(H), Anchor=1(C)
# Source: Leaving=2(H), Anchor=1(N)
# Command: sub grp 2 1 -n SourceMol 2 1
# Result: C-N bond.

# 3. Test sub grp (Implicit Dummy)
# Create Target with Dummy X
new TargetDummy
add atom C 0 0 0
add atom X 1.5 0 0
bond 1 2

# Create Source with Dummy X
new SourceDummy
add atom N 0 0 0
add atom X 1.5 0 0
bond 1 2

switch 4
# Substitute: Anchor=1(C), Implicit Leaving=2(X)
# Source: Anchor=1(N), Implicit Leaving=2(X)
# Command: sub grp 1 -n SourceDummy 1
# Result: C-N bond, X atoms removed.

select :
